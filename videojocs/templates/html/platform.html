{% include 'html/header.html' %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col">
            <div class="card">
                <div class="card-header">
                    <nav class="navbar shadow-none">
                    <div class="nav-item">Platforms - CaOsDa</div>
                    <div class="navbar-nav">
                      <div class="nav-item">
                        <div title="Search platform" data-toggle="modal" data-target="#searchPlatform" class="searchPlatform">
                          <i class="fa-solid fa-magnifying-glass"></i>
                        </div>
                      </div>
                    </div>
                </nav>
                </div>
                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Date added</th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for platform in platforms %}
                    <tr class="border-bottom">
                        <td>{{ platform.name }}</td>
                        <td>{{ platform.date }}</td>
                        <td title="Add videogame" data-platform-id="{{ platform.id }}" data-platform-name="{{ platform.name }}" data-toggle="modal" data-target="#addVideogame" class="addVideogame"><i class="fa-solid fa-gamepad"></i></td>
                        <td title="Add gamer" data-id="{{ platform.id }}" data-toggle="modal" data-target="#addUser" class="addUserToGame"><i class="fa-solid fa-user-plus"></i></td>
                        <td title="Edit platform" data-id="{{ platform.id }}" data-name="{{ platform.name }}" data-date="{{ platform.date }}" data-toggle="modal" data-target="#editPlatform" class="updatePlatform"><i class="fa-solid fa-pen-to-square"></i></td>

                        <form method="POST" action="delete/{{ platform.id }}" class="modal-dialog modal-dialog-centered" role="form" id="removeFormPlatform">
                            {% csrf_token %}
                            <td title="Delete platform" class="deletePlatform">
                                <button type="submit" style="background-color: rgba(255,255,255,0); border: none">
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                            </td>
                        </form>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <p class="text-center text-secondary">No more data</p>
            </div>
            <button type="submit" title="Add new plaftorm" class="bg-dark text-white border-0 w-100 mt-2 p-2 fixed-bottom" data-toggle="modal" data-target="#addPlatform"><i class="fa-solid fa-plus"></i> Add new platform</button>
            </div>
        </div>
    </div>
</div>

<!--Edit-->
<div class="modal fade" id="editPlatform" tabindex="-1" role="dialog" aria-labelledby="editPlatform" aria-hidden="true">
        <form method="POST" action="edit/" class="modal-dialog modal-dialog-centered" role="form" id="editFormPlatform">
        {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTitle">Edit platform</h5>
                    <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                    </button>
                </div>
                <div id="idPlatform" name="idPlatform" class="d-none"></div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <label for="name" class="col-md-4 col-form-label text-md-end">Name</label>
                        <div class="col-md-6">
                            <input id="name" type="text" class="form-control border-0 shadow" name="name">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="date" class="col-md-4 col-form-label text-md-end">Date</label>
                        <div class="col-md-6">
                            <input id="date" type="date" class="form-control border-0 shadow" name="date">
                        </div>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" name="submit" class="btn btn-dark">Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!--Add-->
<div class="modal fade" id="addPlatform" tabindex="-1" role="dialog" aria-labelledby="addPlatform" aria-hidden="true">
        <form method="POST" action="add/" class="modal-dialog modal-dialog-centered" role="form" id="addFormPlatform">
            {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTitle">Add platform</h5>
                    <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                    </button>
                </div>
                <div id="idPlatform" name="idPlatform" class="d-none"></div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <label for="name" class="col-md-4 col-form-label text-md-end">Name</label>
                        <div class="col-md-6">
                            <input id="name" type="text" class="form-control border-0 shadow" name="name">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="date" class="col-md-4 col-form-label text-md-end">Date</label>
                        <div class="col-md-6">
                            <input id="date" type="date" class="form-control border-0 shadow" name="date">
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" name="submit" class="btn btn-dark">Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>
<!--Add Videogame-->
<div class="modal fade" id="addVideogame" tabindex="-1" role="dialog" aria-labelledby="addVideogame" aria-hidden="true">
        <form method="POST" action="addVideogames/{id}" class="modal-dialog modal-dialog-centered" role="form" id="addFormVideogame">
        {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTitle">Add videogame</h5>
                    <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <label for="name" class="col-md-4 col-form-label text-md-end">Name</label>
                        <div class="col-md-6">
                            <input id="name" type="text" class="form-control border-0 shadow" name="name">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="price" class="col-md-4 col-form-label text-md-end">Subscription price</label>
                        <div class="col-md-6">
                            <input id="price" type="number" class="form-control border-0 shadow" name="price">
                        </div>
                    </div>

                    <div class="row mb-3 d-flex align-items-center">
                        <label for="isnew" class="form-check-label col-md-4 col-form-label text-md-end">Is new</label>
                        <div class="form-check form-switch mx-3 col-md-6">
                            <input class="form-check-input" type="checkbox" id="isnew" name="isnew">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="platform" class="col-md-4 col-form-label text-md-end">Platform</label>
                        <div class="col-md-6">
                            <input id="platformOption" type="text" class="form-control border-0 shadow" name="platform"  disabled>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" name="submit" class="btn btn-dark">Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="addUser" tabindex="-1" role="dialog" aria-labelledby="addUser" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="form" id="addFormUser">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addTitle">Add user into platform</h5>
                <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <label for="platform" class="col-md-4 col-form-label text-md-end">Platform</label>
                    <div class="col-md-6">
                        <select id="userSelected" name="userSelected" class="form-select form-control border-0 shadow" aria-label="User selector">
                            <option selected disabled>User selector</option>
                            {% for user in users %}
                            <option value="{{ user.id }}">{{ user.username }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" name="submit" class="btn btn-dark" data-dismiss="modal" data-toggle="modal" data-target="#addUserFinal" id="user-to-platform">Continue</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addUserFinal" tabindex="-1" role="dialog" aria-labelledby="addUserFinal" aria-hidden="true">
        <form method="POST" action="{id}/{id}" class="modal-dialog modal-dialog-centered" role="form" id="addUserToPlatform">
        {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTitle">Do you want to associate this user to this platform?</h5>
                    <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                    </button>
                </div>
                <div class="modal-body text-center">
                    <button type="submit" name="submit3" class="btn btn-danger w-100 mb-1">Yes</button>
                    <button type="button" class="btn btn-secondary w-100" data-dismiss="modal">No</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="searchPlatform" tabindex="-1" role="dialog" aria-labelledby="searchPlatform" aria-hidden="true">
        <form class="modal-dialog modal-dialog-centered" role="form" id="searchFormPlatform">
        {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTitle">Search user platform</h5>
                    <button type="button" class="btn shadow-0" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                    </button>
                </div>
                <div id="idPlatform" name="idPlatform" class="d-none"></div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="input-group mb-3">
                          <input type="text" class="form-control" placeholder="Search" aria-label="Search" aria-describedby="basic-addon2" id="search_user">
                          <div class="input-group-append">
                            <span class="input-group-text" id="basic-addon2"><i class="fa-solid fa-magnifying-glass"></i></span>
                          </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <table class="table d-none" id="search_table">
                            <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Date added</th>
                            </tr>
                            </thead>
                            <tbody id="tbody-searchuser">
                            </tbody>
                        </table>
                        <p class="d-flex justify-content-center" id="user_not_found">User not found</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>
    </div>
</div>